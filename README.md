The artifact contains the source code of our android malware detection method (RGDroid) , the source code of graph attacks which we used to evaluate robustness and the sha256 of apps which we used in our experiments. We give some samples to test the detection performance of RGDroid and some generated adversarial examples. We create a docker image which contains the code and data we mentioned. You can use the "docker pull kkkli/artifact" to pull the docker image. Training and attacking require a GPU and  require more than 10GB GPU memory.
### Data
* **data.csv** - This is data description file. It contains the sha of apps,  the labels of apps and the year of the apps.
* **data/test_data.pkl** This is 500 examples which we used to test the detection performance. The complete test data can be obtained from URL: https://drive.google.com/file/d/11TlfXy_hbwWBTf8caN0DskyoaGzHyU3w/view?usp=sharing
For training, you can download the all data from Androzoo according to the sha of apps. Then you can generate FCGs of apps according to HRAT (https://github.com/zacharykzhao/HRAT). 
* **data/method_entity_embedding_TransE.pkl** This is the API embeddings generated by APIGraph (https://github.com/seclab-fudan/APIGraph)
### Code
* **test.py**  Running the file directly will get the detection result
```
python test.py
```
* **test_robust.py** Output the number of successful attacks for the four attacks. 
```
python test_robust.py
```
* **HRAT** This directory contains HRAT attack code. Run RGDroid.py to start the attack. The attack will take about two days to complete.
```
cd HRAT
python RGDroid.py
```
* **ReWatt** This directory contains ReWatt attack code. Run attack.py to start the attack. The attack will take about one days to complete.
```
cd ReWatt
python attack.py
```
* **BO** This directory contains attack examples. The attack implement refers to https://github.com/xingchenwan/grabnel.
* **prepare_data.py** The scripts first transfer the output. This file converts the files generated by static analysis into adjacency matrixes.
* **commu.py** This script performs community detection and generates edge weights in preparation for  training.



